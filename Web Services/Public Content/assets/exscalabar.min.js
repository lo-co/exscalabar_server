function buildPlotController(e,t,a){angular.module("main").controller(e,["$scope","Data",function(e,n){var o=0;e.menuOptions=[["Q",function(e){o=0}],["IA",function(){o=1}],["f0",function(){o=2}],["abs",function(){o=3}]],$("#chartContainer"+t).CanvasJSChart({axisX:{title:"Time",valueFormatString:"HH:mm:ss"},axisY:{title:a},legend:{verticalAlign:"top",cursor:"pointer",itemclick:function(e){e.dataSeries.visible="undefined"==typeof e.dataSeries.visible||e.dataSeries.visible?!1:!0,e.chart.render()}},data:[{showInLegend:!0,name:"Cell 0",type:"line",xValueType:"dateTime",dataPoints:[]},{showInLegend:!0,name:"Cell 1",type:"line",xValueType:"dateTime",dataPoints:[]},{showInLegend:!0,name:"Cell 2",type:"line",xValueType:"dateTime",dataPoints:[]},{showInLegend:!0,name:"Cell 3",type:"line",xValueType:"dateTime",dataPoints:[]},{showInLegend:!0,name:"Cell 4",type:"line",xValueType:"dateTime",dataPoints:[]}]}),e.chart=$("#chartContainer"+t).CanvasJSChart(),e.chart.render(),e.$on("dataAvailable",function(){for(var a=0;5>a;a++)e.chart.options.data[a].dataPoints=n.pas.cell[a][t],e.chart.render()})}])}!function(){angular.module("main",["ngRoute","ui.bootstrap","ui.bootstrap.contextMenu"])}(),function(){angular.module("main").factory("net",function(){return localStorage.ip||(localStorage.ip="192.168.0.73"),localStorage.port||(localStorage.port="8001"),{ip:localStorage.ip,port:localStorage.port,getNetworkParams:function(){return{ip:this.ip,port:this._port}},setNetworkParams:function(e,t){this._ip=e,this.port=t,localStorage.ip=e,localStorage.port=t},setIP:function(e){this.ip=e,localStorage.ip=e},setPort:function(e){this.port=e,localStorage.port=e},address:function(){return"http://"+this.ip+":"+this.port+"/xService/"}}})}(),function(){angular.module("main").factory("cvt",["$http","net",function(e,t){var a={save:!0,ozone:!1,fctl:[]},n={spk:{vrange:5,voffset:0,f0:1350,df:100,pos:!0,auto:!1,period:360,length:30},las:{f:[],mod:[],vrange:[],voffset:[]}};a.crd={fred:1e3,dcred:50,fblue:2e3,dcblue:50,kred:1,kblue:1,kpmt:[],eblue:!0,ered:!0};return a.getPasSpkCtl=function(){return n.spk},a.setPasSpkCtl=function(e){n.spk=e},a.checkCvt=function(){promise=e.get(t.address()+"General/cvt").success(function(e,t,a,n){})},a}])}(),function(){angular.module("main").config(["$routeProvider",function(e){e.when("/CRDS",{templateUrl:"views/crds.html"}).when("/PAS",{templateUrl:"views/pas.html"}).when("/O3",{templateUrl:"views/cals/ozone.html"}).when("/",{templateUrl:"views/main.html"}).when("/#",{templateUrl:"views/main.html"}).when("/Flows",{templateUrl:"views/flows.html"}).when("/Temperature",{templateUrl:"views/temperature.html"}).when("/Humidifier",{templateUrl:"views/humidifier.html"})}])}(),function(){angular.module("main").controller("MainCtlr",["Data","$scope","$interval","cvt",function(e,t,a,n){a(function(){e.getData()},1e3)}])}(),function(){angular.module("main").directive("chart",function(){return{restrict:"E",link:function(e,t,a){var n=null,o={xaxis:{mode:"time"}};e.$watch(a.ngModel,function(e){n?(n.setData(e),n.setupGrid(),n.draw()):(n=$.plot(t,e,o),t.show())})}}})}(),function(){angular.module("main").factory("Data",["$rootScope","$http","$log","net",function(e,t,a,n){function o(e){var t=new Date(1904,0,1);return t.setSeconds(e),t}function l(){this.f0=[],this.IA=[],this.Q=[],this.p=[],this.abs=[],this.micf=[],this.mict=[],this.pd=[]}function r(){this.tau=[],this.tau0=[],this.taucorr=[],this.tau0corr=[],this.ext=[],this.extcorr=[],this.stdvTau=[],this.etau=[],this.max=[],this.rd=[]}function i(){this.ID="",this.Q=0,this.Q0=0,this.P=0,this.T=0,this.Qsp=0}var s={cTime:null,tObj:new Date,filter:!0,save:!0,o3cal:!1,time:[]},c=300,u=!1;return s.pas={},s.pas.cell=[new l],s.pas.drive=!0,s.flowData=[new i],s.crd={},s.crd.cell=[new r],s.getData=function(){promise=t.get(n.address()+"General/Data").success(function(t,a,n,r){s.time.length-1>=c&&(s.time.pop(),u=!0),s.tObj=o(t.Time);var i=s.tObj.getTime();s.time.unshift(i);for(var d in t.PAS.CellData)s.pas.cell.length-1<d&&s.pas.cell.push(new l),u&&(s.pas.cell[d].f0.pop(),s.pas.cell[d].IA.pop(),s.pas.cell[d].Q.pop(),s.pas.cell[d].p.pop(),s.pas.cell[d].abs.pop()),s.pas.cell[d].f0.unshift([i,t.PAS.CellData[d].derived.f0]),s.pas.cell[d].IA.unshift([i,t.PAS.CellData[d].derived.IA]),s.pas.cell[d].Q.unshift([i,t.PAS.CellData[d].derived.Q]),s.pas.cell[d].p.unshift([i,t.PAS.CellData[d].derived.noiseLim]),s.pas.cell[d].abs.unshift([i,t.PAS.CellData[d].derived.ext]),s.pas.cell[d].micf=t.PAS.CellData[d].MicFreq.Y,s.pas.cell[d].mict=t.PAS.CellData[d].MicTime.Y,s.pas.cell[d].pd=t.PAS.CellData[d].PhotoDiode.Y;s.pas.drive=t.PAS.Drive,e.$broadcast("dataAvailable")}).error(function(){e.$broadcast("dataNotAvailable"),a.debug(status)})},s}])}(),function(){angular.module("main").controller("Sidebar",["$scope","$http","Data","net",function(e,t,a,n){e.save=1,e.filter=1,e.ip=n.ip,e.port=n.port,e.time="Not connected",e.connected=!1,e.changeIP=function(){n.setIP(e.ip)},e.changePort=function(){n.setPort(e.port)},e.time="Not Connected",e.connected=!1,e.$on("dataAvailable",function(){e.time=a.tObj.toLocaleTimeString("en-US",{hour12:!1}),e.filter=a.filter,e.connected=!0}),e.$on("dataNotAvailable",function(){e.connected=!1}),e.saveData=function(){e.save=!e.save;var a=e.save?1:0;t.get(n.address()+"General/Save?save="+a.toString())},e.setFilter=function(){e.filter=0!==e.filter?0:1,t.get(n.address()+"General/Save?save="+e.filter.toString())},e.stop=function(){t.get(n.address()+"General/Stop")}}])}(),function(){angular.module("main").controller("startCal",["$scope","$http","net","cvt",function(e,t,a,n){e.cal=n.ozone,e.startCalibration=function(){e.cal=!e.cal;var o=e.cal?1:0;n.ozone=e.cal,t.get(a.address()+"General/ozone?start="+o.toString())}}])}(),function(){angular.module("main").factory("tableService",["$rootScope",function(e){var t={curTab:"",getTab:function(){return this.curTab},setTab:function(t){this.curTab=t,e.$broadcast("handleBroadcast")}};return t}])}(),function(){angular.module("main").controller("O3Table",["$scope","tableService",function(e,t){e.table_vals=[{id:"Wait",step:"Wait",descr:"Set a wait time in the ozone cal in seconds"},{id:"Filter",step:"Filter",descr:"Boolean that sets the filter state (<code>TRUE</code> or<code>FALSE</code>)"},{id:"Speaker",step:"Speaker",descr:"Boolean that sets the speaker state (<code>TRUE</code> or<code>FALSE</code>)"},{id:"O2 Valve",step:"O2 Valve",descr:"Boolean that sets the O2 valve position (<code>TRUE</code> or<code>FALSE</code>)"},{id:"O3 Valve",step:"O3 Valve",descr:"Boolean that sets the O3 valve state (<code>TRUE</code> or<code>FALSE</code>)"},{id:"O3 Generator",step:"O3 Generator",descr:"Boolean that sets the O3 generator state (<code>TRUE</code> or<code>FALSE</code>)"},{id:"QO2",step:"O2 Flow Rate",descr:"Numeric to set the oxygen flow rate"}],e.clickRow=function(e){t.setTab(e.id.toString())}}])}(),function(){angular.module("main").factory("SaveData",function(){var e={data:[],setData:function(e){this.data=e},getData:function(){return this.data}};return e})}(),function(){angular.module("main").controller("Save",["$scope","SaveData","$http","net",function(e,t,a,n){e.save=function(){var e='<?xml version="1.0" encoding="utf-8"?>\r\n<OZONE>\r\n';t.getData().forEach(function(t){e+="	<"+t.id+">"+t.val+"<\\"+t.id+">\r\n"}),e+="<\\OZONE>",a({method:"POST",url:"http://"+n.address()+"/xService/Calibration/saveCalFile?file_name=test_ang",data:e,headers:{"Content-Type":"application/x-www-form-urlencoded"}})}}])}(),function(){angular.module("main").controller("InputTable",["$scope","tableService","SaveData",function(e,t,a){e.data=[],e.$on("handleBroadcast",function(){var n=t.getTab(),o="";switch(n){case"O3 Valve":case"O2 Valve":case"O3 Generator":case"Filter":o="FALSE";break;case"Wait":case"Speaker":o="20";break;case"QO2":o="100"}e.data.push({id:n,val:o}),a.setData(e.data)})}])}(),function(){angular.module("main").controller("crd",["$scope","net","$http","cvt","Data",function(e,t,a,n,o){var l=function(e,t,a){this.rate=e,this.DC=t,this.k=a};e.blue=new l(n.crd.fblue,n.crd.dcblue,n.crd.kblue),e.red=new l(n.crd.fred,n.crd.dcred,n.crd.kred),e.pmt=n.crd.kpmt,e.benabled=n.crd.eblue,e.renabled=n.crd.ered,e.setbEnable=function(){e.benabled=!e.benabled,n.crd.eblue=e.benabled},e.setrEnable=function(){e.renabled=!e.renabled,n.crd.ered=e.renabled}}])}(),function(){angular.module("main").controller("mainPasCtlr",["$scope","Data",function(e,t){var a=0,n=["Q","IA","f0","abs"];e.menuOptions=[["Q",function(){a=0,e.options.chart.yAxis.axisLabel=n[a]}],["IA",function(){a=1,e.options.chart.yAxis.axisLabel=n[a]}],["f0",function(){a=2,e.options.chart.yAxis.axisLabel=n[a]}],["abs",function(){a=3,e.options.chart.yAxis.axisLabel=n[a]}]],e.options={chart:{type:"lineChart",height:180,margin:{top:20,right:20,bottom:40,left:75},x:function(e){return e.x},y:function(e){return e.y},useInteractiveGuideline:!0,transitionDuration:0,yAxis:{showMaxMin:!1,axisLabel:n[a],tickFormat:function(e){return d3.format(".02f")(e)}},xAxis:{axisLabel:"Time",tickFormat:function(e){return d3.time.format("%X")(new Date(e))}}},title:{enable:!1,text:n[a]+" vs Time"}},e.data=[{values:[],key:"Cell 1 "},{values:[],key:"Cell 2 "},{values:[],key:"Cell 3 "},{values:[],key:"Cell 4 "},{values:[],key:"Cell 5 "}],e.run=!0,e.$on("dataAvailable",function(){for(var o=0;5>o;o++)e.data[o].values=t.pas.cell[o][n[a]]})}])}(),function(){angular.module("main").controller("pas",["$scope","net","$http","cvt","Data","$log",function(e,t,a,n,o,l){e.speaker=n.getPasSpkCtl(),e.cycle={period:360,length:20,auto:!1};var r=10,i=5,s={high:3e3,low:500};e.data=o.pas,e.$on("dataAvailable",function(){e.data=o.pas,e.dataf0=[o.pas.cell[0].f0,o.pas.cell[1].f0,o.pas.cell[2].f0,o.pas.cell[3].f0,o.pas.cell[4].f0],e.dataIA=[o.pas.cell[0].IA,o.pas.cell[1].IA,o.pas.cell[2].IA,o.pas.cell[3].IA,o.pas.cell[4].IA],e.datap=[o.pas.cell[0].p,o.pas.cell[1].p,o.pas.cell[2].p,o.pas.cell[3].p,o.pas.cell[4].p],e.dataQ=[o.pas.cell[0].Q,o.pas.cell[1].Q,o.pas.cell[2].Q,o.pas.cell[3].Q,o.pas.cell[4].Q],e.dataabs=[o.pas.cell[0].abs,o.pas.cell[1].abs,o.pas.cell[2].abs,o.pas.cell[3].abs,o.pas.cell[4].abs]}),e.setPos=function(){e.speaker.pos=!e.speaker.pos;var o=e.speaker.pos?1:0;n.setPasSpkCtl(e.speaker),a.get(t.address()+"PAS_CMD/SpkSw?SpkSw="+o)},e.updateSpkV=function(){e.speaker.vrange>r?e.speaker.vrange=r:e.speaker.vrange<0&&(e.speaker.vrange=0),e.speaker.voffset>i?e.speaker.voffset=i:e.speaker.voffset<0&&(e.speaker.voffset=0),n.setPasSpkCtl(e.speaker),a.get(t.address()+"PAS_CMD/UpdateSpkVparams?Vrange="+e.speaker.vrange+"&Voffset="+e.speaker.voffset)},e.updateSpkF=function(){e.speaker.f0>s.high?e.speaker.f0=s.high:e.speaker.f0<s.low&&(e.speaker.f0=s.low),n.setPasSpkCtl(e.speaker),a.get(t.address()+"PAS_CMD/Spk?df="+e.speaker.df+"&f0="+e.speaker.fc)},e.updateCycle=function(){var n=e.cycle.auto?1:0;a.get(t.address()+"PAS_CMD/UpdateSpkCycle?Length="+e.cycle.length+"&Period="+e.cycle.period+"&Cycle="+n)},e.updateAuto=function(){e.cycle.auto=!e.cycle.auto,e.updateCycle()}}])}(),function(){buildPlotController("plotPASQ","Q","Q"),buildPlotController("plotPASf0","f0","f0 (Hz)"),buildPlotController("plotPASIA","IA","IA (???)"),buildPlotController("plotPASp","p","p (???)"),buildPlotController("plotPASabs","abs","abs (???)")}(),function(){angular.module("main").controller("flowCtlr",["$scope","Data","cvt",function(e,t,a){function n(t,a,n,l){this.ID=t,this.type=a,this.isController=n,this.sp=l,this.index=-1,n&&(e.setpoints.push(l),o+=1,this.index=o)}var o=-1;e.setpoints=[],e.Devices=[new n("Dry Red","mflow",!0,0),new n("Dry Blue","mflow",!1,0),new n("Denuded Blue","mflow",!1,0),new n("Denuded Red","mflow",!0,0),new n("PAS Green","mflow",!1,0),new n("CRD High Humidified","mflow",!1,0),new n("CRD Low Humidified","mflow",!1,0),new n("Mirror Purge Flow","mflow",!1,0),new n("Pressure Controller","pressure",!1,0),new n("O3 Bypass","mflow",!0,0)],e.updateSP=function(){}}])}(),function(){function e(){return{restrict:"E",scope:{},templateUrl:"app/msg/msg.html"}}angular.module("main").directive("msg",e)}(),function(){function e(){return{restrict:"E",scope:{},templateUrl:"app/sidebar/side.html"}}angular.module("main").directive("sidebar",e)}(),function(){function e(){return{restrict:"E",scope:{},templateUrl:"app/navigation/navi.html"}}angular.module("main").directive("navi",e)}(),angular.module("ui.bootstrap.contextMenu",[]).directive("contextMenu",["$parse",function(e){var t=function(e,t,a,n){if(!o)var o=angular.element;o(t.currentTarget).addClass("context");var l=o("<div>");l.addClass("dropdown clearfix");var r=o("<ul>");r.addClass("dropdown-menu"),r.attr({role:"menu"}),r.css({display:"block",position:"absolute",left:t.pageX+"px",top:t.pageY+"px"}),angular.forEach(a,function(a,i){var s=o("<li>");if(null===a)s.addClass("divider");else{var c=o("<a>");c.attr({tabindex:"-1",href:"#"});var u="string"==typeof a[0]?a[0]:a[0].call(e,e,t,n);c.text(u),s.append(c);var d=angular.isDefined(a[2])?a[2].call(e,e,t,u,n):!0;d?s.on("click",function(r){r.preventDefault(),e.$apply(function(){o(t.currentTarget).removeClass("context"),l.remove(),a[1].call(e,e,t,n)})}):(s.on("click",function(e){e.preventDefault()}),s.addClass("disabled"))}r.append(s)}),l.append(r);var i=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight);l.css({width:"100%",height:i+"px",position:"absolute",top:0,left:0,zIndex:9999}),o(document).find("body").append(l),l.on("mousedown",function(e){o(e.target).hasClass("dropdown")&&(o(t.currentTarget).removeClass("context"),l.remove())}).on("contextmenu",function(e){o(e.currentTarget).removeClass("context"),e.preventDefault(),l.remove()})};return function(e,a,n){a.on("contextmenu",function(a){a.stopPropagation(),e.$apply(function(){a.preventDefault();var o=e.$eval(n.contextMenu),l=e.$eval(n.model);if(!(o instanceof Array))throw'"'+n.contextMenu+'" not an array';0!==o.length&&t(e,a,o,l)})})}}]);